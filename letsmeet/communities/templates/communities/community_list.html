{% extends 'base.html' %}
{% load rules community_tags %}

{% block page_title %}
ALL COMMUNITIES
{% endblock %}

{% block content %}
<div class="block-area text-right">
    <a class="btn btn-default" href="{% url 'community_create' %}"><i class="fa fa-plus-circle"></i> Found new community</a>
</div>

<div class="block-area">
    <table class="table table-hover">
        <thead>
            <tr>
                <th>Community</th>
                <th>Your Role</th>
                <th>Subscribers</th>
            </tr>
        </thead>
        <tbody>
            {% for community in community_list %}
            {% if user.is_authenticated %}
            {% get_community_subscription user community as subscription %}
            {% endif %}
            <tr class="clickable" onclick="window.document.location='{{ community.get_absolute_url }}';">
                <td>{{ community.name }}</td>
                <td>{% if subscription %}{{ subscription.get_role_display }}{% else %}Not subscribed{% endif %}</td>
                <td>{{ community.community_subscriptions.count }} <i class="fa fa-users"></i></td>
            </tr>
            {% empty %}
            <tr><td colspan=2><em>No communities yet.</em></td></tr>
        </tbody>
        {% endfor %}
    </table>
</div>
{% endblock content %}
